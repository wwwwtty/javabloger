<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
                                   "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
 <sql-query
   name="sql[find_valid_all]AuthFunction">
   <![CDATA[ SELECT F.* FROM auth_function F WHERE F.enable=TRUE
   ]]>
 </sql-query>
 
  <sql-query
   name="sql[find_role_by_user]AuthRole">
  SELECT R.* FROM auth_role R,auth_role_user_relection RR  
  WHERE RR.role_id=R.role_id AND RR.enabled=TRUE AND R.enabled=TRUE AND RR.user_id=:userID
 </sql-query>
 <sql-query
   name="sql[find_group_by_user]AuthGroup">
	  SELECT G.* FROM auth_group G,auth_role R,auth_role_group_relection RG,auth_role_user_relection RU 
		WHERE RU.role_id=R.role_id 
		AND RU.enable=TRUE 
		AND R.enable=TRUE 
		AND G.enable=TRUE
		AND RG.enable=TRUE
		AND R.role_code=RG.role_id
		AND RG.group_id=G.group_id
		AND RU.user_id=:userID
 </sql-query>
  <sql-query
   name="sql[find_function_by_user]Function">
	SELECT 	R.*
	FROM
	auth_role_user_relection UR,
	auth_role R
	WHERE
	 R.role_id = UR.role_id
	AND UR.user_id = :userID
	AND UR.enabled= TRUE
	AND R.enabled = TRUE
	UNION SELECT R.*
	FROM
	auth_user_group_relection UG,
	auth_group G,
	auth_role_group_relection RG,
	auth_role R
	WHERE
	 G.group_id=UG.group_id
	AND UG.user_id = :userID
	AND UG.enabled = TRUE
	AND G.enabled = TRUE
	AND RG.role_id=R.role_id
	AND RG.group_id=G.group_id
	AND RG.enabled=TRUE
	AND R.enabled=true
 </sql-query>
 
</hibernate-mapping>
